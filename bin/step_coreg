#!/bin/tcsh -f
#
# Coregisters the slave image directly to the master (only recommended
# for small baselines)
#
# Andy Hooper, Jul 2006
#

set WORKDIR=".."

if (! -e $WORKDIR/coreg.dorisin) then
    cp $DORIS_SCR/coreg.dorisin $WORKDIR
endif

set first = `grep 'First_pixel ' master.res | gawk 'END {print $4}'`
set last = `grep 'Last_pixel ' master.res | gawk 'END {print $4}'`
set first_l = `grep 'First_line ' master.res | gawk 'END {print $4}'`
set last_l = `grep 'Last_line ' master.res | gawk 'END {print $4}'`

echo "coreg_pos $first_l $last_l $first $last 0 0" >matbgparms.txt
matlab -nojvm -nosplash -nodisplay < $STAMPS/matlab/batchjob.m >> step_coreg.log

sed -n '1,/* End_coarse_correl:/p' coreg.out > tmp_coreg.$$
echo "*******************************************************************" >> tmp_coreg.$$
mv tmp_coreg.$$ coreg.out

doris $WORKDIR/coreg.dorisin >> step_coreg.log




